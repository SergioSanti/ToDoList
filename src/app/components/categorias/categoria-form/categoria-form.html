<div class="categoria-form-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1 class="page-title">
        {{ isEditMode() ? 'Editar Categoria' : 'Nova Categoria' }}
      </h1>
      <p class="page-subtitle">
        {{ isEditMode() ? 'Atualize as informações da categoria' : 'Preencha os dados para criar uma nova categoria' }}
      </p>
    </div>
    <button 
      type="button"
      (click)="cancel()"
      class="btn btn-secondary"
    >
      Cancelar
    </button>
  </div>

  <!-- Form -->
  <div class="form-container">
    <form [formGroup]="categoriaForm" (ngSubmit)="onSubmit()" class="categoria-form">
      <!-- Nome -->
      <div class="form-group">
        <label for="nome" class="form-label">Nome *</label>
        <input
          type="text"
          id="nome"
          formControlName="nome"
          class="form-control"
          [class.is-invalid]="categoriaForm.get('nome')?.invalid && categoriaForm.get('nome')?.touched"
          placeholder="Digite o nome da categoria"
        >
        @if (getFieldError('nome')) {
          <div class="invalid-feedback">
            {{ getFieldError('nome') }}
          </div>
        }
      </div>

      <!-- Descrição -->
      <div class="form-group">
        <label for="descricao" class="form-label">Descrição *</label>
        <textarea
          id="descricao"
          formControlName="descricao"
          class="form-control"
          [class.is-invalid]="categoriaForm.get('descricao')?.invalid && categoriaForm.get('descricao')?.touched"
          placeholder="Descreva a categoria"
          rows="3"
        ></textarea>
        @if (getFieldError('descricao')) {
          <div class="invalid-feedback">
            {{ getFieldError('descricao') }}
          </div>
        }
      </div>

      <!-- Cor -->
      <div class="form-group">
        <label class="form-label">Cor *</label>
        <div class="color-picker">
          <div class="color-options">
            @for (cor of coresPredefinidas; track cor) {
              <div 
                class="color-option"
                [class.selected]="categoriaForm.get('cor')?.value === cor"
                [style.background-color]="cor"
                (click)="selectColor(cor)"
                [title]="cor"
              ></div>
            }
          </div>
          <div class="color-input">
            <input
              type="color"
              formControlName="cor"
              class="form-control color-input-field"
              [class.is-invalid]="categoriaForm.get('cor')?.invalid && categoriaForm.get('cor')?.touched"
            >
            <span class="color-value">{{ categoriaForm.get('cor')?.value }}</span>
          </div>
        </div>
        @if (getFieldError('cor')) {
          <div class="invalid-feedback">
            {{ getFieldError('cor') }}
          </div>
        }
      </div>

      <!-- Preview -->
      <div class="form-group">
        <label class="form-label">Preview</label>
        <div class="category-preview">
          <div class="preview-color" [style.background-color]="categoriaForm.get('cor')?.value"></div>
          <div class="preview-content">
            <h4 class="preview-name">{{ categoriaForm.get('nome')?.value || 'Nome da categoria' }}</h4>
            <p class="preview-description">{{ categoriaForm.get('descricao')?.value || 'Descrição da categoria' }}</p>
          </div>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="isLoading() || categoriaForm.invalid"
        >
          @if (isLoading()) {
            <span class="spinner-border spinner-border-sm me-2"></span>
          }
          {{ isLoading() ? 'Salvando...' : (isEditMode() ? 'Atualizar' : 'Criar') }}
        </button>
        
        <button
          type="button"
          (click)="cancel()"
          class="btn btn-secondary"
          [disabled]="isLoading()"
        >
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>