<div class="container">
  <h2>Tabela de Tarefas</h2>

  <!-- FUNCIONALIDADE DE BUSCA/FILTRO COM PIPES -->
  <!-- Campo de pesquisa que usa ngModel para busca em tempo real -->
  <div class="mb-3">
    <label for="nomePesquisa" class="form-label">PESQUISA:</label>
    <input type="text" [(ngModel)]="nomePesquisa" id="nomePesquisa" class="form-control" placeholder="Digite título para pesquisar...">
  </div>

  <!-- Tabela com filtro aplicado via Pipe -->
  @if((listaTarefas() | filtroPesquisa:nomePesquisa).length > 0) {
    <table class="table table-striped table-hover">
      <thead class="table-primary">
        <tr>
          <th>ID</th>
          <th>TÍTULO</th>
          <th>DESCRIÇÃO</th>
          <th>CATEGORIA</th> <!-- RELACIONAMENTO: Mostra categoria da tarefa -->
          <th>PRIORIDADE</th>
          <th>CONCLUÍDA</th>
          <th colspan="2">AÇÃO</th>
        </tr>
      </thead>
      <tbody>
        <!-- Loop com filtro aplicado via Pipe filtroPesquisa -->
        @for(tarefa of listaTarefas() | filtroPesquisa:nomePesquisa; track tarefa.id) {
          <tr>
            <td>{{tarefa.id}}</td>
            <td>{{tarefa.titulo}}</td>
            <td>{{tarefa.descricao}}</td>
            <!-- RELACIONAMENTO: Busca nome da categoria pelo ID -->
            <td>{{getCategoriaNome(tarefa.categoriaId)}}</td>
            <td>{{tarefa.prioridade}}</td>
            <td>{{tarefa.concluida ? 'Sim' : 'Não'}}</td>
            <!-- NAVEGAÇÃO SPA: RouterLink para edição -->
            <td><a class="btn btn-primary" routerLink="/edit/{{tarefa.id}}">Editar</a></td>
            <!-- CRUD: Operação de exclusão -->
            <td><a class="btn btn-danger" (click)="deletar(tarefa.id)">Deletar</a></td>
          </tr>
        }
      </tbody>
    </table>
  } @else {
    <h4>Não há tarefas cadastradas!</h4>
  }
</div>
